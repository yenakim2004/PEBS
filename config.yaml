# PEBS Configuration File

# Data paths
data:
  nsduh_path: "data/raw/NSDUH_2002_2018_Tab.tsv"
  smni_train_path: "data/raw/SMNI_CMI_TRAIN/"
  smni_test_path: "data/raw/SMNI_CMI_TEST/"
  processed_path: "data/processed/"
  train_test_split: 0.2
  random_state: 42

  # Selected NSDUH columns for memory efficiency (reduces 3,662 → ~75 columns)
  # Set to null to load all columns
  # NOTE: Column names verified from actual NSDUH_2002_2018_Tab.tsv file
  nsduh_selected_columns:
    # Demographics (14 variables)
    - "AGE2"           # Age
    - "IRSEX"          # Sex
    - "NEWRACE2"       # Race/ethnicity
    - "IRFAMIN3"       # Family income
    - "IRMARIT"        # Marital status
    - "CATAGE"         # Age category
    - "CATAG2"         # Age category (detailed)
    - "CATAG3"         # Age category (alternate)
    - "INCOME"         # Personal income
    - "SERVICE"        # Military service
    - "IRHHSIZ2"       # Household size
    - "COUTYP2"        # County type
    - "PDEN90"         # Population density
    - "POVERTY2"       # Poverty level

    # Alcohol use core (9 variables)
    - "ALCEVER"        # Ever used alcohol
    - "ALCTRY"         # Ever tried alcohol
    - "ALCYRTOT"       # Past year alcohol use
    - "ALCDAYS"        # Days used alcohol
    - "ALCFLAG"        # Alcohol use flag
    - "ALCYR"          # Alcohol use past year
    - "ALCMON"         # Alcohol use past month
    - "ALCYDAYS"       # Days used past year
    - "ALCMDAYS"       # Days used past month

    # Alcohol problem indicators (20 variables)
    - "ALCLOTTM"       # Lots of time obtaining/using
    - "ALCGTOVR"       # Got over effects
    - "ALCLIMIT"       # Limit amount
    - "ALCKPLMT"       # Keep limit
    - "ALCNDMOR"       # Need more for effect
    - "ALCLSEFX"       # Less effect with same amount
    - "ALCCUTDN"       # Cut down use
    - "ALCCUTEV"       # Ever cut down
    - "ALCCUT1X"       # Cut down past year
    - "ALCWD2SX"       # Withdrawal 2+ symptoms
    - "ALCWDSMT"       # Withdrawal symptoms
    - "ALCEMOPB"       # Emotional problems
    - "ALCEMCTD"       # Emotional problems continued
    - "ALCPHLPB"       # Physical problems
    - "ALCPHCTD"       # Physical problems continued
    - "ALCLSACT"       # Less activities
    - "ALCSERPB"       # Serious problems
    - "ALCPDANG"       # Physical danger
    - "ALCLAWTR"       # Legal trouble
    - "ALCFMFPB"       # Family/friend problems
    - "ALCFMCTD"       # Family problems continued

    # Substance use (13 variables)
    - "IRALCFY"        # Alcohol first use age
    - "IRMJFY"         # Marijuana first use age
    - "CIGEVER"        # Ever smoked cigarettes
    - "MJEVER"         # Ever used marijuana
    - "COCEVER"        # Ever used cocaine
    - "HEREVER"        # Ever used heroin
    - "METHAMEVR"      # Ever used methamphetamine
    - "TOBYR"          # Tobacco use past year
    - "ILLYR"          # Illicit drug use past year
    - "COCYR"          # Cocaine past year
    - "HERYR"          # Heroin past year
    - "INHALYR"        # Inhalants past year
    - "METHAMYR"       # Methamphetamine past year

    # Tobacco (5 variables)
    - "CIGTRY"         # Ever tried cigarettes
    - "CIGMON"         # Cigarettes past month
    - "IRCIGRC"        # Cigarette recency
    - "CIGDLYMO"       # Daily cigarette use past month
    - "CIGDLYFU"       # Daily cigarette use

    # Health and treatment (2 variables)
    - "HEALTH"         # Overall health
    - "TXYREVER"       # Ever received treatment

    # Survey metadata (4 variables)
    - "YEAR"           # Survey year
    - "QUARTER"        # Survey quarter
    - "VESTR"          # Variance estimation stratum
    - "VEREP"          # Variance estimation replicate

    # Additional alcohol treatment (8 variables)
    - "ALCTRMT"        # Alcohol treatment
    - "ALCPINS"        # Private insurance coverage
    - "ALCPCARE"       # Private care
    - "ALCPCAID"       # Medicaid coverage
    - "ALCPPUBP"       # Other public coverage
    - "ALCPSAVE"       # Savings
    - "ALCPFMLY"       # Family coverage
    - "ALCPCORT"       # Court ordered

# EEG processing
eeg:
  sampling_rate: 256
  bands:
    delta: [0.5, 4]
    theta: [4, 8]
    alpha: [8, 13]
    beta: [13, 30]
    gamma: [30, 50]

# Model configurations
models:
  # Environmental Risk Index (ERI) Model
  eri:
    type: "RandomForest"
    n_estimators: 100
    max_depth: 10
    min_samples_split: 20
    min_samples_leaf: 10
    random_state: 42
    n_jobs: -1

  # Biological Vulnerability Index (BVI) Model
  bvi:
    type: "LogisticRegression"
    max_iter: 1000
    random_state: 42
    n_jobs: -1

  # Risk Classification
  risk:
    eri_threshold: 0.5
    bvi_threshold: 0.5
    categories:
      0: "Low Risk"
      1: "Medium-Environmental"
      2: "Medium-Biological"
      3: "High Risk"

# Preprocessing
preprocessing:
  missing_threshold: 0.5  # Remove columns with >50% missing values
  standardize: true

  # PCA dimensionality reduction (방안 2)
  pca:
    enabled: true                # Enable/disable PCA
    n_components: 0.95           # Number of components (int) or variance ratio (float 0-1)
    # If n_components is float (e.g., 0.95), keep components explaining 95% variance
    # If n_components is int (e.g., 50), keep exactly 50 components
    whiten: false                # Apply whitening (mean=0, std=1 per component)
    random_state: 42

# Training
training:
  verbose: true
  save_models: true
  models_path: "models/"

# Visualization
visualization:
  save_figures: true
  figures_path: "figures/"
  dpi: 300
  format: "png"

# Memory optimization for 16GB RAM
memory:
  nsduh_chunksize: 10000
  enable_gc: true
  low_memory_mode: true
